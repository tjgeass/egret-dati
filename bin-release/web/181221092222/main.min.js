var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),BeginScreen=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/BeginSence.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,ScreenControl.loadGame,ScreenControl),this.btn_guize.addEventListener(egret.TouchEvent.TOUCH_TAP,ScreenControl.loadHome,ScreenControl),this.init()},t.prototype.init=function(){this.playAnimation(this.tweenGroup,!0)},t.prototype.onTweenGroupComplete=function(){console.log("TweenGroup play completed."),this.tweenGroup.play()},t.prototype.playAnimation=function(e,t){if(t)for(var n in e.items)e.items[n].props={loop:!0};e.play()},t}(eui.Component);__reflect(BeginScreen.prototype,"BeginScreen");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?i(r):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.startCreateScene=function(){GameData.stage=this,ScreenControl.loadBegin()},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t},t.prototype.startAnimation=function(e){var t=this,n=new egret.HtmlTextParser,i=e.map(function(e){return n.parse(e)}),r=this.textfield,o=-1,a=function(){o++,o>=i.length&&(o=0);var e=i[o];r.textFlow=e;var n=egret.Tween.get(r);n.to({alpha:1},200),n.wait(2e3),n.to({alpha:0},200),n.call(a,t)};a()},t}(eui.UILayer);__reflect(Main.prototype,"Main");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,i){function r(e){t.call(i,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var LocalStorageControl=function(){function e(){}return e.initData=function(){egret.localStorage.clear(),egret.localStorage.setItem("icon",InitConfigData.icon.toString()),egret.localStorage.setItem("chapter",InitConfigData.chapter.toString()),egret.localStorage.setItem("prompt",InitConfigData.prompt.toString()),egret.localStorage.setItem("pause",InitConfigData.pause.toString()),egret.localStorage.setItem("reset",InitConfigData.reset.toString()),egret.localStorage.setItem("isInited","1")},e.openChapter=function(){var e=Number(egret.localStorage.getItem("chapter"));100>e&&egret.localStorage.setItem("chapter",(e+1).toString())},e.getChapter=function(){return Number(egret.localStorage.getItem("chapter"))},e.addIcon=function(e){var t=Number(egret.localStorage.getItem("icon"));egret.localStorage.setItem("icon",(t+e).toString())},e.useIcon=function(e){var t=Number(egret.localStorage.getItem("icon"));egret.localStorage.setItem("icon",(t-e).toString())},e.getIcon=function(){return Number(egret.localStorage.getItem("icon"))},e.isInited=function(){return!!egret.localStorage.getItem("isInited")},e.getPropsItemNum=function(e){return Number(egret.localStorage.getItem(e))},e.addPropsItemNum=function(e){var t=Number(egret.localStorage.getItem(e))+1;egret.localStorage.setItem(e,t.toString())},e.usePropsItemNum=function(e){var t=Number(egret.localStorage.getItem(e))-1;egret.localStorage.setItem(e,t.toString())},e}();__reflect(LocalStorageControl.prototype,"LocalStorageControl");var NewsConfig=function(){function e(){}return e.getData=function(e){var t=RES.getRes("newsList_json");return t[e]},e.getNewsNum=function(){var e=RES.getRes("newsList_json");return Object.keys(e).length},e}();__reflect(NewsConfig.prototype,"NewsConfig");var ScreenControl=function(){function e(){}return e.loadBegin=function(){this.load(new BeginScreen)},e.loadHome=function(){this.load(new HomeScreen)},e.loadGame=function(){this.load(new GameScreen)},e.load=function(e){GameData.stage.removeChildren();var t=e;GameData.screen=t,GameData.stage.addChild(t)},e}();__reflect(ScreenControl.prototype,"ScreenControl");var GameData=function(){function e(){}return e.getData=function(e){var t=RES.getRes("gameData_json");return t[e]},e.getDataNum=function(){var e=RES.getRes("gameData_json");return e.length},e.resetData=function(){this.answerNum=0,this.chapter=1},e.saveLocalData=function(e){var t=egret.localStorage.getItem(e);t=String(Number(t)+1),egret.localStorage.setItem(e,t);var n=egret.localStorage.getItem("sum");n=String(Number(n)+1),egret.localStorage.setItem("sum",n)},e.getRank=function(e){for(var t=0,n=0;n<Number(e);n++){var i=Number(egret.localStorage.getItem(String(n)));console.log(n+"答对"+i),t+=i}var r=Number(egret.localStorage.getItem("sum"));console.log("共计"+r);var o=(t/r*100).toFixed(2);return o},e.maxRow=6,e.maxColumn=6,e.cardHorizontalSpacing=52,e.cardVerticalSpacing=52,e.stageW=960,e.stageH=640,e.elementWidth=480/e.maxColumn,e.promptNum=0,e.time=180,e.level=20,e.chapter=1,e.answerNum=0,e.backgroundImage="defaultBg_png",e}();__reflect(GameData.prototype,"GameData");var InitConfigData=function(){function e(){}return e.icon=1e3,e.chapter=0,e.prompt=3,e.pause=3,e.reset=3,e}();__reflect(InitConfigData.prototype,"InitConfigData");var PropsPrice=function(){function e(){}return e.prompt=500,e.reset=500,e.pause=500,e}();__reflect(PropsPrice.prototype,"PropsPrice");var TimerData=function(){function e(){}return e.time=90,e.pauseTime=5,e.eleDisappearTime=200,e}();__reflect(TimerData.prototype,"TimerData");var GameElement=function(e){function t(t,n,i,r){var o=e.call(this)||this;return o.id=t,o.question=n,o.answer=i,o.explain=r,o}return __extends(t,e),t.prototype.update=function(e){},t}(egret.Sprite);__reflect(GameElement.prototype,"GameElement");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var GameScreen=function(e){function t(){var t=e.call(this)||this;return t.name="Game",t.skinName="resource/eui_skins/GameSence.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.init()},t.prototype.init=function(){this.gm.thisParent=this,GameData.gameMap=this.gm},t.prototype.showResult=function(e){this.gm.touchChildren=!1;var t=new ResultView;t.verticalCenter=0,t.horizontalCenter=0,this.addChild(t),setTimeout(function(){ScreenControl.loadBegin()},6e4)},t}(eui.Component);__reflect(GameScreen.prototype,"GameScreen");var HomeScreen=function(e){function t(){var t=e.call(this)||this;return t.name="Home",t.skinName="resource/eui_skins/HomeSence.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,ScreenControl.loadBegin,ScreenControl),this.init()},t.prototype.init=function(){},t}(eui.Component);__reflect(HomeScreen.prototype,"HomeScreen");var BackBtnView=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/MenuSkin.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.back,this)},t.prototype.back=function(){ScreenControl.loadBegin()},t.prototype.loadGame=function(){ScreenControl.loadGame()},t}(eui.Component);__reflect(BackBtnView.prototype,"BackBtnView");var CardView=function(e){function t(t,n,i,r){void 0===t&&(t=1),void 0===n&&(n="字");var o=e.call(this)||this;return o.elePadding=5,o.skinName="resource/eui_skins/CardViewSkin.exml",o.touchChildren=!1,o.id=t,o.lb_text.text=n,o.gp_id=i,o.click_num=r,o}return __extends(t,e),t.prototype.addBorder=function(){this.bg.strokeWeight=3},t.prototype.removeBorder=function(){this.bg.strokeWeight=null},t.prototype.clicked=function(){this.click_num=this.click_num-1,0==this.click_num&&(this.touchEnabled=!1)},t.prototype.targetX=function(e){if(void 0===e&&(e=!0),e)var t=this.x;else var t=this.x+this.width;return t},t.prototype.targetY=function(){var e=this.y+this.height/2;return e},t}(eui.Component);__reflect(CardView.prototype,"CardView");var GameMap=function(e){function t(){var t=e.call(this)||this;return t.isReady=!1,t.skinName="resource/eui_skins/GameMapSkin.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.btn_true.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pass,this),this.btn_false.addEventListener(egret.TouchEvent.TOUCH_TAP,this.lose,this),this.btn_next.addEventListener(egret.TouchEvent.TOUCH_TAP,this.next,this),this.init()},t.prototype.init=function(){GameData.resetData(),this.createTimer(),this.initView()},t.prototype.createTimer=function(){this.lb_time.text=GameData.time.toString(),this.timer=new egret.Timer(1e3,GameData.time),this.timer.addEventListener(egret.TimerEvent.TIMER,this.update,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.complete,this),this.timer.start()},t.prototype.update=function(){var e=this.timer.repeatCount-this.timer.currentCount;this.lb_time.text=e.toString()},t.prototype.complete=function(){this.timer.removeEventListener(egret.TimerEvent.TIMER,this.update,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.complete,this),this.showresult()},t.prototype.initView=function(){this.initData(),this.lb_question.text=GameData.elements[GameData.chapter-1].question,this.lb_explain.text=GameData.elements[GameData.chapter-1].explain,this.gp_que.visible=!0,this.gp_explain.visible=!1,this.gp_result.visible=!1},t.prototype.initData=function(){for(var e=new Array,t=0;t<GameData.getDataNum();t++){var n=t+1,i=GameData.getData(t),r=new GameElement(n,i.question,i.answer,i.explain);e.push(r)}GameData.elements=new Array,e=e.sort(function(){return.5-Math.random()}),GameData.elements=e},t.prototype.next=function(){GameData.chapter==GameData.level?this.showresult():(GameData.chapter=GameData.chapter+1,this.lb_question.text=GameData.elements[GameData.chapter-1].question,this.lb_explain.text=GameData.elements[GameData.chapter-1].explain,this.lb_num.text="第"+GameData.chapter+"题",this.gp_explain.visible=!1,this.timer.start())},t.prototype.pass=function(){1==GameData.elements[GameData.chapter-1].answer?this.showExplain(!0):this.showExplain(!1)},t.prototype.lose=function(){0==GameData.elements[GameData.chapter-1].answer?this.showExplain(!0):this.showExplain(!1)},t.prototype.showExplain=function(e){this.timer.stop(),e?(GameData.answerNum=GameData.answerNum+1,this.lb_title.text="你真棒，回答正确！",this.gp_explain.visible=!0,this.onResourceLoadComplete("true_mp3")):(this.lb_title.text="很遗憾，回答错误。",this.gp_explain.visible=!0,this.onResourceLoadComplete("false_mp3"))},t.prototype.showresult=function(){var e=String(GameData.answerNum);GameData.saveLocalData(e),this.lb_text0.textFlow=[{text:"您共答对了 ",style:{size:24}},{text:e,style:{textColor:16697705,size:30}},{text:" 道题 ",style:{size:24}}];var t=String(Math.round(GameData.answerNum/GameData.level*100));this.lb_text1.textFlow=[{text:"答题正确率  ",style:{size:24}},{text:t,style:{textColor:16697705,size:30}},{text:" % ",style:{size:24}}];var n=String(this.timer.currentCount);this.lb_text2.textFlow=[{text:"共计用时  ",style:{size:24}},{text:n,style:{textColor:16697705,size:30}},{text:" 秒 ",style:{size:24}}];var i=GameData.getRank(e);this.lb_text3.textFlow=[{text:"击败了  ",style:{size:24}},{text:i,style:{textColor:16697705,size:30}},{text:" % 的小伙伴 ",style:{size:24}}],this.lb_num.text="你的成绩",this.onResourceLoadComplete("result_mp3"),this.btn_restart.addEventListener(egret.TouchEvent.TOUCH_TAP,ScreenControl.loadBegin,ScreenControl),this.gp_explain.visible=!1,this.gp_que.visible=!1,this.gp_result.visible=!0},t.prototype.onResourceLoadComplete=function(e){var t=RES.getRes(e);t.play(0,1)},t}(eui.Component);__reflect(GameMap.prototype,"GameMap");var LoseView=function(e){function t(){var t=e.call(this)||this;return t.touchEnabled=!0,t.init(),t}return __extends(t,e),t.prototype.init=function(){this.createView()},t.prototype.createView=function(){var e=new egret.Bitmap;e.width=GameData.stageW,e.height=GameData.stageH,e.texture=RES.getRes("lose_png"),this.addChild(e)},t}(egret.Sprite);__reflect(LoseView.prototype,"LoseView");var MenuView=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/MenuSkin.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.btn_home.addEventListener(egret.TouchEvent.TOUCH_TAP,this.loadHome,this),this.btn_game.addEventListener(egret.TouchEvent.TOUCH_TAP,this.loadGame,this),this.init()},t.prototype.init=function(){switch(GameData.screen.name){case"Home":this.btn_home.enabled=!1;break;case"Article":this.btn_article.enabled=!1;break;case"Game":this.btn_game.enabled=!1}},t.prototype.loadHome=function(){ScreenControl.loadHome()},t.prototype.loadGame=function(){ScreenControl.loadGame()},t}(eui.Component);__reflect(MenuView.prototype,"MenuView");var NewsView=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/NewsViewSkin.exml",t}return __extends(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this._title},set:function(e){this._title=e,this.lbl_text.text=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"image",{get:function(){return this._image},set:function(e){this._image=e,this.img.source=RES.getRes(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"desc",{get:function(){return this._desc},set:function(e){this._desc=e},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(NewsView.prototype,"NewsView");var PassView=function(e){function t(){var t=e.call(this)||this;return t.touchEnabled=!0,t.init(),t}return __extends(t,e),t.prototype.init=function(){this.createView()},t.prototype.createView=function(){var e=new eui.Image;e.horizontalCenter=0,e.verticalCenter=0,e.source=RES.getRes("win_png"),this.addChild(e)},t}(egret.Sprite);__reflect(PassView.prototype,"PassView");var ResultView=function(e){function t(){var t=e.call(this)||this;return t.init(),t}return __extends(t,e),t.prototype.init=function(){var e=new eui.Image;e.horizontalCenter=0,e.verticalCenter=0,e.source=RES.getRes("win_png"),this.anchorOffsetX=e.width/2,this.anchorOffsetY=e.height/2,this.addChild(e)},t}(eui.Component);__reflect(ResultView.prototype,"ResultView");var TimerView=function(e){function t(){var t=e.call(this)||this;return t._timeTxt="00:00:00",t.initView(),t.addEventListener("timeChange",t.onTimeReflash,t),t}return __extends(t,e),Object.defineProperty(t.prototype,"timeTxt",{get:function(){return this._timeTxt},enumerable:!0,configurable:!0}),t.prototype.initView=function(){this.timeLabel=new eui.Label,this.addChild(this.timeLabel),this._timeCount=(new Date).getTime(),this._time=new egret.Timer(1e3)},t.prototype.startPlay=function(){this._time.addEventListener(egret.TimerEvent.TIMER,this.onTimeHandler,this),this._time.start()},t.prototype.stopTime=function(){this._time.stop(),this._time.removeEventListener(egret.TimerEvent.TIMER,this.onTimeHandler,this)},t.prototype.onTimeHandler=function(e){var t=(new Date).getTime()-this._timeCount;this._timeTxt=this.parseTime(t),this.dispatchEvent(new egret.Event("timeChange"))},t.prototype.onTimeReflash=function(e){this.timeLabel.text=this._timeTxt},t.prototype.parseTime=function(e){var t=0,n=0,i=0;return t=Math.floor(e/36e5),n=Math.floor(e%36e5/6e4),i=Math.floor(e%6e4/1e3),this.getTwoLength(t)+":"+this.getTwoLength(n)+":"+this.getTwoLength(i)},t.prototype.getTwoLength=function(e){return 10>e?"0"+e:""+e},t}(eui.Component);__reflect(TimerView.prototype,"TimerView");