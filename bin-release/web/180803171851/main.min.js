var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ArticleSceen=function(e){function t(){var t=e.call(this)||this;return t.name="Article",t.skinName="resource/eui_skins/ArticleSence.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.close,this),this.init()},t.prototype.init=function(){this.gp_newView.visible=!1;for(var e=1;e<=NewsConfig.getNewsNum();e++){var t=new NewsView;t.touchChildren=!1,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickCard,this),t.title=NewsConfig.getData(e).title,t.image=NewsConfig.getData(e).image,t.desc=NewsConfig.getData(e).desc,this.scroll_group.addChild(t),this.scroll_news.horizontalScrollBar.autoVisibility=!1}},t.prototype.clickCard=function(e){var t=e.target;this.gp_newView.visible=!0,this.new_image.source=t.image,this.new_title.text=t.title,this.new_desc.text=t.desc},t.prototype.close=function(){this.gp_newView.visible=!1},t}(eui.Component);__reflect(ArticleSceen.prototype,"ArticleSceen");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?i(r):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.startCreateScene=function(){GameData.stage=this,SceenControl.loadBegin()},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t},t.prototype.startAnimation=function(e){var t=this,n=new egret.HtmlTextParser,i=e.map(function(e){return n.parse(e)}),r=this.textfield,o=-1,a=function(){o++,o>=i.length&&(o=0);var e=i[o];r.textFlow=e;var n=egret.Tween.get(r);n.to({alpha:1},200),n.wait(2e3),n.to({alpha:0},200),n.call(a,t)};a()},t}(eui.UILayer);__reflect(Main.prototype,"Main");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,i){function r(e){t.call(i,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var LocalStorageControl=function(){function e(){}return e.initData=function(){egret.localStorage.clear(),egret.localStorage.setItem("icon",InitConfigData.icon.toString()),egret.localStorage.setItem("chapter",InitConfigData.chapter.toString()),egret.localStorage.setItem("prompt",InitConfigData.prompt.toString()),egret.localStorage.setItem("pause",InitConfigData.pause.toString()),egret.localStorage.setItem("reset",InitConfigData.reset.toString()),egret.localStorage.setItem("isInited","1")},e.openChapter=function(){var e=Number(egret.localStorage.getItem("chapter"));100>e&&egret.localStorage.setItem("chapter",(e+1).toString())},e.getChapter=function(){return Number(egret.localStorage.getItem("chapter"))},e.addIcon=function(e){var t=Number(egret.localStorage.getItem("icon"));egret.localStorage.setItem("icon",(t+e).toString())},e.useIcon=function(e){var t=Number(egret.localStorage.getItem("icon"));egret.localStorage.setItem("icon",(t-e).toString())},e.getIcon=function(){return Number(egret.localStorage.getItem("icon"))},e.isInited=function(){return!!egret.localStorage.getItem("isInited")},e.getPropsItemNum=function(e){return Number(egret.localStorage.getItem(e))},e.addPropsItemNum=function(e){var t=Number(egret.localStorage.getItem(e))+1;egret.localStorage.setItem(e,t.toString())},e.usePropsItemNum=function(e){var t=Number(egret.localStorage.getItem(e))-1;egret.localStorage.setItem(e,t.toString())},e}();__reflect(LocalStorageControl.prototype,"LocalStorageControl");var NewsConfig=function(){function e(){}return e.getData=function(e){var t=RES.getRes("newsList_json");return t[e]},e.getNewsNum=function(){var e=RES.getRes("newsList_json");return Object.keys(e).length},e}();__reflect(NewsConfig.prototype,"NewsConfig");var SceenControl=function(){function e(){}return e.loadBegin=function(){this.load(new BeginSceen)},e.loadHome=function(){this.load(new HomeSceen)},e.loadArticle=function(){this.load(new ArticleSceen)},e.loadGame=function(){this.load(new GameSceen)},e.load=function(e){GameData.stage.removeChildren();var t=e;GameData.sceen=t,GameData.stage.addChild(t)},e}();__reflect(SceenControl.prototype,"SceenControl");var GameData=function(){function e(){}return e.resetData=function(){this.lineNum=6},e.maxRow=6,e.maxColumn=6,e.cardHorizontalSpacing=52,e.cardVerticalSpacing=52,e.stageW=960,e.stageH=640,e.elementWidth=480/e.maxColumn,e.elementTypes=["e0_png","e1_png","e2_png","e3_png","e4_png","e5_png","e6_png","e7_png"],e.parentSprite=[e.firstSprite,e.secondSprite,e.thirdSprite],e.dataLen=3,e.lineNum=6,e.firstData=["一两黄金","十锭白银","100克铜"],e.secondData=["100","10","1"],e.thirdData=["房子","猪肉","白面"],e.promptNum=0,e.level=1,e.backgroundImage="defaultBg_png",e}();__reflect(GameData.prototype,"GameData");var InitConfigData=function(){function e(){}return e.icon=1e3,e.chapter=0,e.prompt=3,e.pause=3,e.reset=3,e}();__reflect(InitConfigData.prototype,"InitConfigData");var PropsPrice=function(){function e(){}return e.prompt=500,e.reset=500,e.pause=500,e}();__reflect(PropsPrice.prototype,"PropsPrice");var TimerData=function(){function e(){}return e.time=90,e.pauseTime=5,e.eleDisappearTime=200,e}();__reflect(TimerData.prototype,"TimerData");var GameElement=function(e){function t(t,n,i){var r=e.call(this)||this;return r.id=t,r.name=n,r.gp_id=i,r.click_num=i%2?1:2,r}return __extends(t,e),t.prototype.update=function(e){this.id=e},t}(egret.Sprite);__reflect(GameElement.prototype,"GameElement");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var BeginSceen=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/BeginSence.exml",t.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,t.loadHome,t),t}return __extends(t,e),t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.loadHome=function(){SceenControl.loadHome()},t}(eui.Component);__reflect(BeginSceen.prototype,"BeginSceen");var GameSceen=function(e){function t(){var t=e.call(this)||this;return t.name="Game",t.skinName="resource/eui_skins/GameMainSence.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.init()},t.prototype.init=function(){this.chapter=0,this.gm.thisParent=this,GameData.gameMap=this.gm},t.prototype.showResult=function(e){this.gm.touchChildren=!1;var t=new ResultView(e);this.addChild(t)},t}(eui.Component);__reflect(GameSceen.prototype,"GameSceen");var HomeSceen=function(e){function t(){var t=e.call(this)||this;return t.name="Home",t.skinName="resource/eui_skins/HomeSence.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.init()},t.prototype.init=function(){},t}(eui.Component);__reflect(HomeSceen.prototype,"HomeSceen");var BackBtnView=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/MenuSkin.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.back,this)},t.prototype.back=function(){SceenControl.loadBegin()},t.prototype.loadGame=function(){SceenControl.loadGame()},t}(eui.Component);__reflect(BackBtnView.prototype,"BackBtnView");var CardView=function(e){function t(t,n,i,r){void 0===t&&(t=1),void 0===n&&(n="字");var o=e.call(this)||this;return o.elePadding=5,o.skinName="resource/eui_skins/CardViewSkin.exml",o.touchChildren=!1,o.id=t,o.lb_text.text=n,o.gp_id=i,o.click_num=r,o}return __extends(t,e),t.prototype.addBorder=function(){this.bg.strokeWeight=3},t.prototype.removeBorder=function(){this.bg.strokeWeight=null},t.prototype.clicked=function(){this.click_num=this.click_num-1,0==this.click_num&&(this.touchEnabled=!1)},t.prototype.targetX=function(e){if(void 0===e&&(e=!0),e)var t=this.x;else var t=this.x+this.width;return t},t.prototype.targetY=function(){var e=this.y+this.height/2;return e},t}(eui.Component);__reflect(CardView.prototype,"CardView");var GameMap=function(e){function t(){var t=e.call(this)||this;return t.isReady=!1,t.skinName="resource/eui_skins/GameMapSkin.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.init()},t.prototype.init=function(){var e=this;this.gp_main.visible=!1,this.gp_explain.visible=!0,GameData.resetData(),this.createBottomSprite(),this.createAllElement(),this.createTimer(),setTimeout(function(){e.gp_main.visible=!0,e.gp_explain.visible=!1},1e4)},t.prototype.createTimer=function(){this.timer=new egret.Timer(1e3,10),this.timer.addEventListener(egret.TimerEvent.TIMER,this.update,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.complete,this),this.timer.start()},t.prototype.update=function(){var e=this.timer.repeatCount-this.timer.currentCount;this.lb_time.text=e.toString()},t.prototype.complete=function(){this.timer.removeEventListener(egret.TimerEvent.TIMER,this.update,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.complete,this),this.gp_main.visible=!0,this.gp_explain.visible=!1},t.prototype.createBottomSprite=function(){var e=new egret.Sprite;this.gp_main.addChild(e),GameData.eleParentSprite=e},t.prototype.createAllElement=function(){this.touchChildren=!1,this.isReady=!1,GameData.eleParentSprite.removeChildren(),this.addData(this.gp1,GameData.firstData,1),this.addData(this.gp2,GameData.secondData,2),this.addData(this.gp3,GameData.thirdData,3),this.touchChildren=!0,this.isReady=!0},t.prototype.addData=function(e,t,n){for(var i=new Array,r=0;r<GameData.dataLen;r++){var o=r+1;console.log(e);var a=new GameElement(o,t[r],n);i.push(a)}GameData.elements=new Array,i=i.sort(function(){return.5-Math.random()});for(var s=0;s<GameData.dataLen;s++){GameData.elements[s]=i.shift();var a=GameData.elements[s],c=new CardView(a.id,a.name,a.gp_id,a.click_num);c.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickCard,this),e.addChild(c)}},t.prototype.clickCard=function(e){var t=e.target;console.log(Math.abs(-1));t.parent;null==this.tap1?(this.tap1=t,this.tap1.addBorder(),this.gp2.touchChildren=!0):(this.tap2=t,this.tap2.gp_id==this.tap1.gp_id?(this.tap1.removeBorder(),this.tap1=t,this.tap1.addBorder(),this.tap2=null):1!=Math.abs(this.tap1.gp_id-this.tap2.gp_id)?(this.tap2.removeBorder(),this.tap2=null):this.tap1.id==this.tap2.id?(this.lineToline(this.tap1,this.tap2),this.gp3.touchChildren=!0,this.tap1.removeBorder(),this.tap1=null,this.tap2.removeBorder(),this.tap2=null):(this.tap1.removeBorder(),this.tap1=null,this.tap2.removeBorder(),this.tap2=null)),this.onResourceLoadComplete()},t.prototype.lineToline=function(e,t){var n=!1;e.gp_id-t.gp_id==1&&(n=!0),GameData.eleParentSprite.graphics.lineStyle(2,14461291),GameData.eleParentSprite.graphics.moveTo(e.targetX(n)+e.parent.x,e.targetY()+e.parent.y),GameData.eleParentSprite.graphics.lineTo(t.targetX(!n)+t.parent.x,t.targetY()+t.parent.y),e.clicked(),t.clicked(),GameData.lineNum--,0==GameData.lineNum&&(console.log("全部完成"),this.pass())},t.prototype.returnCards=function(e){this.tap1=null,this.tap2=null,this.flipBackTimer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.returnCards,this)},t.prototype.timeout=function(){GameData.eleParentSprite.numChildren?this.lose():this.pass()},t.prototype.pass=function(){console.log(this.thisParent),this.thisParent.showResult(!0)},t.prototype.lose=function(){this.thisParent.showResult(!1)},t.prototype.onResourceLoadComplete=function(){var e=RES.getRes("right_mp3");e.play(0,1)},t}(eui.Component);__reflect(GameMap.prototype,"GameMap");var LoseView=function(e){function t(){var t=e.call(this)||this;return t.touchEnabled=!0,t.init(),t}return __extends(t,e),t.prototype.init=function(){this.createView()},t.prototype.createView=function(){var e=new egret.Bitmap;e.width=GameData.stageW,e.height=GameData.stageH,e.texture=RES.getRes("lose_png"),this.addChild(e)},t}(egret.Sprite);__reflect(LoseView.prototype,"LoseView");var MenuView=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/MenuSkin.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.btn_home.addEventListener(egret.TouchEvent.TOUCH_TAP,this.loadHome,this),this.btn_game.addEventListener(egret.TouchEvent.TOUCH_TAP,this.loadGame,this),this.btn_article.addEventListener(egret.TouchEvent.TOUCH_TAP,this.loadArticle,this),this.init()},t.prototype.init=function(){switch(GameData.sceen.name){case"Home":this.btn_home.enabled=!1;break;case"Article":this.btn_article.enabled=!1;break;case"Game":this.btn_game.enabled=!1}},t.prototype.loadHome=function(){SceenControl.loadHome()},t.prototype.loadGame=function(){SceenControl.loadGame()},t.prototype.loadArticle=function(){SceenControl.loadArticle()},t}(eui.Component);__reflect(MenuView.prototype,"MenuView");var NewsView=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/NewsViewSkin.exml",t}return __extends(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this._title},set:function(e){this._title=e,this.lbl_text.text=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"image",{get:function(){return this._image},set:function(e){this._image=e,this.img.source=RES.getRes(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"desc",{get:function(){return this._desc},set:function(e){this._desc=e},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(NewsView.prototype,"NewsView");var PassView=function(e){function t(){var t=e.call(this)||this;return t.touchEnabled=!0,t.init(),t}return __extends(t,e),t.prototype.init=function(){this.createView()},t.prototype.createView=function(){var e=new eui.Image;e.horizontalCenter=0,e.verticalCenter=0,e.source=RES.getRes("win_png"),this.addChild(e)},t}(egret.Sprite);__reflect(PassView.prototype,"PassView");var ResultView=function(e){function t(t){var n=e.call(this)||this;return n.init(t),n}return __extends(t,e),t.prototype.init=function(e){this.createView(e)},t.prototype.createView=function(e){var t;t=e?new PassView:new LoseView,this.addChild(t)},t.prototype.update=function(){},t}(egret.Sprite);__reflect(ResultView.prototype,"ResultView");var TimerView=function(e){function t(){var t=e.call(this)||this;return t._timeTxt="00:00:00",t.initView(),t.addEventListener("timeChange",t.onTimeReflash,t),t}return __extends(t,e),Object.defineProperty(t.prototype,"timeTxt",{get:function(){return this._timeTxt},enumerable:!0,configurable:!0}),t.prototype.initView=function(){this.timeLabel=new eui.Label,this.addChild(this.timeLabel),this._timeCount=(new Date).getTime(),this._time=new egret.Timer(1e3)},t.prototype.startPlay=function(){this._time.addEventListener(egret.TimerEvent.TIMER,this.onTimeHandler,this),this._time.start()},t.prototype.stopTime=function(){this._time.stop(),this._time.removeEventListener(egret.TimerEvent.TIMER,this.onTimeHandler,this)},t.prototype.onTimeHandler=function(e){var t=(new Date).getTime()-this._timeCount;this._timeTxt=this.parseTime(t),this.dispatchEvent(new egret.Event("timeChange"))},t.prototype.onTimeReflash=function(e){this.timeLabel.text=this._timeTxt},t.prototype.parseTime=function(e){var t=0,n=0,i=0;return t=Math.floor(e/36e5),n=Math.floor(e%36e5/6e4),i=Math.floor(e%6e4/1e3),this.getTwoLength(t)+":"+this.getTwoLength(n)+":"+this.getTwoLength(i)},t.prototype.getTwoLength=function(e){return 10>e?"0"+e:""+e},t}(eui.Component);__reflect(TimerView.prototype,"TimerView");